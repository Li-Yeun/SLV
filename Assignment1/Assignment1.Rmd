---
title: "Supervised Learning and Visualisation"
subtitle: "Assignment 1"
author: "Abdool Al-Khaledi, Amalia Tsakali, Li-Yeun Xu, Willem van Veluw"
date: "2022-09-19"
output: html_document
---

## Packages
```{r }
install.packages("ggpubr")
library(ggpubr)
```
## Libraries
```{r, message = FALSE, warning = FALSE}
library(tidyverse)

```

## Load the data
In this section we load and pre-process the data. This means that we define which variables are factors and change their labels. We will also add some variables in order to make pretty plots.\\

Just for illustration: we can use Latex-language in markdown files:
\begin{align*}
  2x+ 1 & = 5\\
  2x & = 4\\
  x & = 2
\end{align*}
```{r, message = FALSE}
data <- 
  read_csv("data/spotify_top_charts_22.csv") %>% 
  select(-uri) %>% 
  mutate(key = recode(key, 
                      "0"="C","1"="C#","2"="D","3"="D#","4"="E","5"="F","6"="F#","7"="G","8"="G#","9"="A",
                      "10"="A#","11"="B") 
                      %>% as.factor()) %>% 
  mutate(mode = recode(mode, 
                      "0" = "minor", "1" = "major") 
                      %>% as.factor()) %>% 
  mutate(time_signature = recode(time_signature, 
                      "1" = "1/4", "3" = "3/4", "4" = "4/4", "5" = "5/4") 
                      %>% as.factor()) %>% 
  mutate(colab = case_when(grepl(",", artist_names) ~ "YES", !grepl(",", artist_names) ~ "NO") %>% as.factor())

```


## Inspect the data
```{r}
View(data)
```

## Transform and Clean the data
```{r}
```

## Create Tables
```{r}
# Todo
```

## Create Plots
```{r}
numeric_features_indices <- c(3,4,5,6,8,10,11,12,13,14,16)
# length of the song name as a feature
categorical_features_indices <- c(7,9,15,17)

# Features vs Features
for (i in 1:length(numeric_features_indices))
  for (j in 1:length(numeric_features_indices))
    if(i != j)
      for (k in 0:length(categorical_features_indices))
      {
        if(k==0)
        {
          plot <- data %>% 
                    ggplot(aes_string(y=colnames(data[numeric_features_indices[i]]), x=colnames(data[numeric_features_indices[j]]))) + 
                    geom_point() + stat_cor() + theme_minimal()
          print(plot)
        }
        else
        {
          plot <- data %>% 
              ggplot(aes_string(y=colnames(data[numeric_features_indices[i]]), x=colnames(data[numeric_features_indices[j]]))) + 
              geom_point() + stat_cor() + facet_wrap(colnames(data[categorical_features_indices[k]])) + theme_minimal()
          print(plot)
        }
      }
      
```
```{r}
plot1 <- data %>% 
  ggplot(aes(x = loudness, y = energy)) +
  geom_point() +
  geom_smooth(method='lm', colour = "red") +
  xlim(-15, 0) +
  theme_minimal()

plot1
```
```{r}
plot2 <- data %>% 
  ggplot(aes(x = acousticness, y = energy)) +
  geom_point() +
  geom_smooth(method='lm', colour = "red") +
  theme_minimal()

plot2
```
## Explain what you did and why (maximum 5 paragraphs total) if applicable, note findings such as missingness, outliers or unlikely values or group differences, etcetera.

